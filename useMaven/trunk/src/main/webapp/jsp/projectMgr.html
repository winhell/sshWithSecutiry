<script type="text/javascript" src="../js/ajaxUpload.js"></script>
<script type="text/javascript">

pjOptions = {func:"project",height:450,width:800};
new AjaxUpload("uploadbtn",{name:"upfile",action:"uploadZip.action",onComplete:uploadComplete});

function uploadComplete(file,res){
	var data=eval("("+res+")");
	if(data.result=="fail"){
		$.messager.alert("Wrong!",data.msg);
	}else{
		$.messager.show("OK","文件上传成功！");
	}
	
}

function downFile(value,row,index){
	return "<a href='doc/"+row.registerId+".doc'>下载</a>";
}
</script>

<div class="easyui-layout" data-options="fit : true,border : false">
<div data-options="region:'north',title:'文件批量导入',border:false,iconCls:'icon-columns'"
		style="height: 100px; background: #f4f4f4;padding:15px;">
	<button id="uploadbtn">上传打包的项目文件(zip格式)</button>
</div>

<div data-options="region:'center',border:false">
    <table id="project_gridTable" title="项目录入管理" class="easyui-datagrid"
    	data-options="fit:true, fitColumns:true,pagination:true,toolbar:'#projtoolbar',idfield:'id',url:'getProjectList.action',singleSelect:false,striped:true,
			pageSize : 10,	pageList : [ 10, 20, 30, 40, 50 ]">
    <thead>
    <tr>
    	<th field="ck" checkbox="true"></th>
    	<th field="name" width="100px">项目名称</th>
    	<th field="projectTypeName" width="100px">计划类别</th>
    	<th data-options="field:'proportyName',width:100">课题性质</th>
    	<th data-options="field:'applyer',width:100">项目负责人</th>
    	<th field="registerId" width="100px">注册号</th>
    	<th data-options="field:'depart',width:100">承担单位</th>
    	<th data-options="field:'progressName',width:100">项目进度</th>
    	<th data-options="field:'contract',width:100">合同编号</th>
    	<th data-options="field:'registerDate',sortable:'true',width:100">申报时间</th>
    	<th data-options="field:'download',
    		formatter:downFile,width:100">论文下载</th>
   	</tr>
     </thead>
    </table>
    	<div id="projtoolbar">
		<a href="#" class="easyui-linkbutton" iconCls="icon-add" plain="true" onclick="addRecord(pjOptions)">增加项目</a>
		<a href="#" class="easyui-linkbutton" iconCls="icon-edit" plain="true" onclick="editRecord(pjOptions)">修改项目</a>
		<a href="#" class="easyui-linkbutton" iconCls="icon-remove" plain="true" onclick="deleteRecord(pjOptions)">删除项目</a>
	</div>
    
</div>
</div>