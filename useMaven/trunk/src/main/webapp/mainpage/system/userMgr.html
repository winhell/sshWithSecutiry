<!-- BEGIN PAGE HEADER-->
<div class="row">
    <div class="col-md-12">
        <!-- BEGIN PAGE TITLE & BREADCRUMB-->
        <h3 class="page-title">
           用户管理
        </h3>
        <ul class="page-breadcrumb breadcrumb">
            <li class="btn-group">
                <button type="button" class="btn blue dropdown-toggle" data-toggle="dropdown" data-hover="dropdown" data-delay="1000" data-close-others="true">
				<span>
					Actions
				</span>
                    <i class="fa fa-angle-down"></i>
                </button>
                <ul class="dropdown-menu pull-right" role="menu">
                    <li>
                        <a href="#">
                            Action
                        </a>
                    </li>
                    <li>
                        <a href="#">
                            Another action
                        </a>
                    </li>
                    <li>
                        <a href="#">
                            Something else here
                        </a>
                    </li>
                    <li class="divider">
                    </li>
                    <li>
                        <a href="#">
                            Separated link
                        </a>
                    </li>
                </ul>
            </li>
            <li>
                <i class="fa fa-home"></i>
                <a href="../index.html">
                    Home
                </a>
                <i class="fa fa-angle-right"></i>
            </li>
            <li>
                <a href="#">
                </a>
            </li>
        </ul>
        <!-- END PAGE TITLE & BREADCRUMB-->
    </div>
</div>
<!-- END PAGE HEADER-->
<!-- BEGIN PAGE CONTENT-->
<div class="row">
    <div class="col-md-12">
        <div class="portlet box green">
            <div class="portlet-title">
                <div class="caption">
                    <i class="fa fa-cogs"></i>用户列表
                </div>
                <div class="actions">
                <a href="#" class="btn blue" id="addLink"><i class="fa fa-plus"></i> 增加</a>
                <a href="#" class="btn yellow" id="editLink">
                    <i class="fa fa-pencil"></i>
                    编辑
                </a>
                <a href="javascript:;" class="btn red" id="deleteLink">
                    <i class="fa fa-trash-o"></i>
                    删除
                </a>
                </div>
            </div>
            <div class="portlet-body">

                <table class="table table-striped table-bordered table-hover" id="gridtable">
                    <thead>
                    <tr>
                        <th style="width:40px;">
                            <input type="checkbox" class="group-checkable" data-set="#gridtable .checkboxes">
                        </th>
                        <th style="width:20px;">用户名</th>
                        <th style="width:20px;">用户角色</th>
                        <th style="width:20px;">创建时间</th>
                        <th style="width:20px;">所在单位</th>
                        <th style="width: 20px">操作</th>
                    </tr>
                    </thead>
                </table>
            </div>
        </div>
    </div>
</div>
<!-- END PAGE CONTENT-->
<div id="additemFormDiv" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="portlet box green">
                <div class="portlet-title">
                    <div class="caption">
                        <i class="fa fa-reorder"></i><span id="formTitle">Form Actions On Bottom</span>
                    </div>
                </div>
                <div class="portlet-body form">
                    <!-- BEGIN FORM-->
                    <form class="form-horizontal" id="additemForm" method="post">
                        <div class="form-body">
                            <div class="form-group">
                                <label class="col-md-3 control-label">用户名</label>
                                <div class="col-md-8">
                                    <input id='name' type="text" name="name" class="form-control" placeholder="用户名"></div>
                            </div>
                            <div class="form-group">
                                <label class="col-md-3 control-label">用户密码</label>
                                <div class="col-md-8">
                                        <input id='password' type="password" name="password" class="form-control" placeholder="密码">
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-md-3 control-label">所在部门</label>
                                <div class="col-md-8">
                                    <input id='departId' type="text" class="form-control" name="departId" placeholder="所在部门">
                                </div>
                            </div>
                        </div>
                        <div class="form-actions fluid">
                            <div class="col-md-offset-3 col-md-9">
                                <button type="button" class="btn blue" id="formSubmit">提交</button>
                                <button type="button" class="btn default" id="formClose">关闭</button>
                            </div>
                        </div>
                    </form>
                    <!-- END FORM-->
                </div>
            </div>
        </div>
    </div>
</div>
<div id="assignRolesDiv" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="portlet box green">
                <div class="portlet-title">
                    <div class="caption">
                        <i class="fa fa-reorder"></i>分配用户角色
                    </div>
                </div>
                <div class="portlet-body form">
                    <!-- BEGIN FORM-->
                    <form class="form-horizontal" method="post">
                        <div class="form-body">
                            <div class="form-group">


                                    <input name="userid" type="hidden" id="userID"/>

                                <div class="col-md-9">
                                    <div class="checkbox-list" id="rolesDiv">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-actions fluid">
                            <div class="col-md-offset-3 col-md-9">
                                <button type="button" class="btn blue">提交</button>
                                <button type="button" class="btn default" onclick="javascript:$('#assignRolesDiv').modal('hide');">关闭</button>
                            </div>
                        </div>
                    </form>
                    <!-- END FORM-->
                </div>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript" src="assets/plugins/jquery-bootpag/jquery.bootpag.min.js"></script>
<script type="text/javascript" src="assets/plugins/data-tables/jquery.dataTables.js"></script>
<script type="text/javascript" src="assets/scripts/user/jquery.datatable.manager.js"></script>
<script type="text/javascript" src="assets/scripts/user/jquery.form.js"></script>
<script type="text/javascript" src="assets/scripts/custom/commonCRUD.js"></script>
<script>
    $(function () {
        var opts = {
            action: "listuser.action",
            param: {
                page: 1,
                rows: 10
            },
            aoColumns: [
                {
                    "mData": "id",
                    "bSortable": false,
                    "mRender": function (data, type, full) {
                        return "<input class='checkboxes' type='checkbox' value='" + data + "'/>";
                    }
                },
                {
                    "mData": "name",
                    "bSortable": false
                },
                {
                    "mData":"rolesName",
                    "bSortable":false
                },
                {
                    "mData": "createtime",
                    "bSortable": false
                },{
                    "mData":"departId",
                    "bSortable":false
                },{
                    "mData":"id",
                    "bSortable":false,
                    "mRender":function(data){
                        return '<a href="javascript:assignRoles(\''+data+'\');" class="btn btn-xs purple"> 分配角色</a>';
                    }
                }
            ],
            dataProp: "rows",
            pageProp: "total",
            bootpag: {
                maxVisible: 5
            }
        }
        $("#gridtable").tableManager(opts);
    });
    function assignRoles(id){
        $('#userID').val(id);
        $.getJSON('getAllRoles.action',function(data){
            $('#rolesDiv').empty();
            $.each(data,function(index,item){
                $('#rolesDiv').append('<div class="checker"><span> <input type="checkbox" name="roleids" value="'+item.id+'"/></span></div>'+item.comment);
            });
            $('#assignRolesDiv').modal('show');
        });
    }
</script>